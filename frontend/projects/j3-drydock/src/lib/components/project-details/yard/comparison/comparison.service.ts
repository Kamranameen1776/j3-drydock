import { Injectable } from '@angular/core';

export const stubFunctionsTree = [
  {
    data: {
      name: 'Ship General',
      number: '1',
      uom: '',
      quantity: ''
    },
    children: [
      {
        data: {
          name: 'Ship General Sub 1',
          number: '1.1',
          uom: '',
          quantity: ''
        }
      },
      {
        data: {
          name: 'Ship General Sub 2',
          number: '1.2',
          uom: '33',
          quantity: '111'
        }
      },
      {
        data: {
          name: 'Ship General Sub 3',
          number: '1.3',
          uom: '',
          quantity: ''
        }
      }
    ]
  },
  {
    data: {
      name: 'Ship General 1',
      number: '2',
      uom: '',
      quantity: ''
    },
    children: [
      {
        data: {
          name: 'Ship General 1 Sub 1',
          number: '2.1',
          uom: '',
          quantity: ''
        }
      },
      {
        data: {
          name: 'Ship General  1 Sub 2',
          number: '2.2',
          uom: '',
          quantity: ''
        }
      }
    ]
  },
  {
    data: {
      name: 'Ship General 2',
      number: '3',
      uom: '',
      quantity: ''
    },
    children: [
      {
        data: {
          name: 'Ship General 2 Sub 1',
          number: '3.1',
          uom: '',
          quantity: ''
        }
      },
      {
        data: {
          name: 'Ship General 2 Sub 2',
          number: '3.2',
          uom: '',
          quantity: ''
        }
      }
    ]
  },
  {
    data: {
      name: 'Ship General 3',
      number: '4',
      uom: '',
      quantity: ''
    },
    children: [
      {
        data: {
          name: 'Ship General 3 Sub 1',
          number: '4.1',
          uom: '',
          quantity: ''
        }
      },
      {
        data: {
          name: 'Ship General 3 Sub 2',
          number: '4.2',
          uom: '',
          quantity: ''
        }
      }
    ]
  },
  {
    data: {
      name: 'Ship General 4',
      number: '5',
      uom: '',
      quantity: ''
    },
    children: [
      {
        data: {
          name: 'Ship General 4 Sub 1',
          number: '5.1',
          uom: '',
          quantity: ''
        }
      },
      {
        data: {
          name: 'Ship General 4 Sub 2',
          number: '5.2',
          uom: '',
          quantity: ''
        }
      }
    ]
  },
  {
    data: {
      name: 'Ship General 5',
      number: '6',
      uom: '',
      quantity: ''
    },
    children: [
      {
        data: {
          name: 'Ship General 5 Sub 1',
          number: '6.1',
          uom: '',
          quantity: ''
        }
      },
      {
        data: {
          name: 'Ship General 5 Sub 2',
          number: '6.2',
          uom: '',
          quantity: ''
        }
      }
    ]
  },
  {
    data: {
      name: 'Ship General',
      number: '7',
      uom: '',
      quantity: ''
    },
    children: [
      {
        data: {
          name: 'Ship General 6 Sub 1',
          number: '7.1',
          uom: '',
          quantity: ''
        }
      },
      {
        data: {
          name: 'Ship General 6 Sub 2',
          number: '7.2',
          uom: '',
          quantity: ''
        }
      }
    ]
  },
  {
    data: {
      name: 'Ship General 7',
      number: '8',
      uom: '',
      quantity: ''
    },
    children: [
      {
        data: {
          name: 'Ship General 7 Sub 1',
          number: '8.1',
          uom: '',
          quantity: ''
        }
      },
      {
        data: {
          name: 'Ship General 7 Sub 2',
          number: '8.2',
          uom: '',
          quantity: ''
        }
      }
    ]
  },
  {
    data: {
      name: 'Ship General 8',
      number: '9',
      uom: '',
      quantity: ''
    },
    children: [
      {
        data: {
          name: 'Ship General 8 Sub 1',
          number: '9.1',
          uom: '',
          quantity: ''
        }
      },
      {
        data: {
          name: 'Ship General 8 Sub 2',
          number: '9.2',
          uom: '',
          quantity: ''
        }
      }
    ]
  },
  {
    data: {
      name: 'Ship General 9',
      number: '10',
      uom: '',
      quantity: ''
    },
    children: [
      {
        data: {
          name: 'Ship General 9 Sub 1',
          number: '10.1',
          uom: '',
          quantity: ''
        }
      },
      {
        data: {
          name: 'Ship General 9 Sub 2',
          number: '10.2',
          uom: '',
          quantity: ''
        }
      }
    ]
  }
];

export const stubYardRows = [
  {
    number: '1',
    header: 'Ship General',
    uom: '',
    quantity: '',
    amount: '1',
    unitPrice: '2'
  },
  {
    number: '1.1',
    header: 'Ship General Sub 1',
    uom: '',
    quantity: '200',
    amount: '104',
    unitPrice: '124'
  },
  {
    number: '1.2',
    header: 'Ship General Sub 2',
    uom: '',
    quantity: '',
    amount: '100',
    unitPrice: '100'
  },
  {
    number: '1.3',
    header: 'Ship General Sub 3',
    uom: '',
    quantity: '',
    amount: '1020',
    unitPrice: '100'
  },
  {
    number: '2',
    header: 'Ship General',
    uom: '',
    quantity: '300',
    amount: '10026',
    unitPrice: '10026'
  },
  {
    number: '2.1',
    header: 'Ship General Sub 1',
    uom: '',
    quantity: '1',
    amount: '10025',
    unitPrice: '10025'
  },
  {
    number: '2.2',
    header: 'Ship General Sub 2',
    uom: '',
    quantity: '400',
    amount: '10024',
    unitPrice: '10024'
  },
  {
    number: '3',
    header: 'Ship General',
    uom: '',
    quantity: '100',
    amount: '10023',
    unitPrice: '10023'
  },
  {
    number: '3.1',
    header: 'Ship General Sub 1',
    uom: '',
    quantity: '10022',
    amount: '10022',
    unitPrice: '10022'
  },
  {
    number: '3.2',
    header: 'Ship General Sub 2',
    uom: '',
    quantity: '10021',
    amount: '10021',
    unitPrice: '10021'
  },
  {
    number: '4',
    header: 'Ship General',
    uom: '',
    quantity: '10020',
    amount: '10020',
    unitPrice: '10020'
  },
  {
    number: '4.1',
    header: 'Ship General Sub 1',
    uom: '',
    quantity: '10019',
    amount: '10019',
    unitPrice: '10019'
  },
  {
    number: '4.2',
    header: 'Ship General Sub 2',
    uom: '',
    quantity: '10018',
    amount: '10018',
    unitPrice: '10018'
  },
  {
    number: '5',
    header: 'Ship General',
    uom: '',
    quantity: '10017',
    amount: '10017',
    unitPrice: '10017'
  },
  {
    number: '5.1',
    header: 'Ship General Sub 1',
    uom: '',
    quantity: '10016',
    amount: '10016',
    unitPrice: '10016'
  },
  {
    number: '5.2',
    header: 'Ship General Sub 2',
    uom: '',
    quantity: '10015',
    amount: '10015',
    unitPrice: '10015'
  },
  {
    number: '6',
    header: 'Ship General',
    uom: '',
    quantity: '10014',
    amount: '10014',
    unitPrice: '10014'
  },
  {
    number: '6.1',
    header: 'Ship General Sub 1',
    uom: '',
    quantity: '10013',
    amount: '10013',
    unitPrice: '10013'
  },
  {
    number: '6.2',
    header: 'Ship General Sub 2',
    uom: '',
    quantity: '10012',
    amount: '10012',
    unitPrice: '10012'
  },
  {
    number: '7',
    header: 'Ship General',
    uom: '',
    quantity: '10011',
    amount: '10011',
    unitPrice: '10011'
  },
  {
    number: '7.1',
    header: 'Ship General Sub 1',
    uom: '',
    quantity: '10010',
    amount: '10010',
    unitPrice: '10010'
  },
  {
    number: '7.2',
    header: 'Ship General Sub 2',
    uom: '',
    quantity: '1009',
    amount: '1009',
    unitPrice: '1009'
  },
  {
    number: '8',
    header: 'Ship General',
    uom: '',
    quantity: '1008',
    amount: '1008',
    unitPrice: '1008'
  },
  {
    number: '8.1',
    header: 'Ship General Sub 1',
    uom: '',
    quantity: '1007',
    amount: '1007',
    unitPrice: '1007'
  },
  {
    number: '8.2',
    header: 'Ship General Sub 2',
    uom: '',
    quantity: '1006',
    amount: '1006',
    unitPrice: '1006'
  },
  {
    number: '9',
    header: 'Ship General',
    uom: '',
    quantity: '1005',
    amount: '1005',
    unitPrice: '1005'
  },
  {
    number: '9.1',
    header: 'Ship General Sub 1',
    uom: '',
    quantity: '1004',
    amount: '1004',
    unitPrice: '1004'
  },
  {
    number: '9.2',
    header: 'Ship General Sub 2',
    uom: '',
    quantity: '1003',
    amount: '1003',
    unitPrice: '1003'
  },
  {
    number: '10',
    header: 'Ship General',
    uom: '',
    quantity: '1002',
    amount: '1002',
    unitPrice: '1003'
  },
  {
    number: '10.1',
    header: 'Ship General Sub 1',
    uom: '',
    quantity: '1001',
    amount: '1001',
    unitPrice: '1001'
  },
  {
    number: '10.2',
    header: 'Ship General Sub 2',
    uom: '',
    quantity: '1000',
    amount: '1000',
    unitPrice: '1000'
  }
];

export const comparisonGridName = 'comparisonGridName';

@Injectable({ providedIn: 'root' })
export class ComparisonService {
  private readonly baseColumns = [
    {
      field: 'number',
      header: '#',
      width: '100px'
    },
    {
      field: 'name',
      header: 'Specification',
      width: '250px'
    },
    {
      field: 'uom',
      header: 'UOM',
      width: '50px'
    },
    {
      field: 'quantity',
      header: 'Quantity',
      width: '80px'
    }
  ];

  private readonly cardColumns = [
    {
      field: `amount`,
      header: 'Amount',
      width: '100px'
    },
    {
      field: `quantity`,
      header: 'Quantity',
      width: '60px'
    },
    {
      field: `unitPrice`,
      header: 'Un.Price',
      width: '60px'
    },
    {
      field: `uom`,
      header: 'UOM',
      width: '196px'
    }
  ];

  constructor() {}
  // fixme type
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  getFunctionsTree(loadedYards = [], functions = []) {
    return stubFunctionsTree.map((item) => {
      return { ...item, isRoot: true };
    });
  }

  getBaseColumns() {
    return [...this.baseColumns];
  }

  getCardColumns() {
    return this.cardColumns;
  }

  getYardsWithYardRows(yards = []) {
    return yards.map((yard) => {
      return { ...yard, rows: stubYardRows };
    });
  }

  getExpandedRowsSet(leftRowsTree) {
    const rowsSet = new Set();
    return this.getRowsSet(rowsSet, leftRowsTree);
  }

  getGridFilters() {}
  // TODO fixme type and logix
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  sortYardsBy(yards: any[], sortBy: string) {
    return yards;
  }

  private getRowsSet(rowsSet, leftRowsTree) {
    leftRowsTree.forEach((row) => {
      if (row.isRoot) {
        rowsSet.add(row.data.number);
      }
      if (row.expanded) {
        rowsSet.add(row.data.number);
        row.children?.forEach((child) => {
          rowsSet.add(child.data.number);
        });
      }
      if (row.children) {
        this.getRowsSet(rowsSet, row.children);
      }
    });
    return rowsSet;
  }
}
