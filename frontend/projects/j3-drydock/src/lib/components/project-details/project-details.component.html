<jb-growl [content]="growlMessage$ | async"></jb-growl>

<jb-task-manager-details
  #detailsComponent
  *ngIf="sectionsConfig"
  [topSectionConfig]="topSectionConfig"
  [customedThreeDotActions]="customedThreeDotActions"
  [threeDotsActionsShow]="threeDotsActionsShow"
  [sectionsConfig]="sectionsConfig"
  [tmDetails]="tmDetails"
  [moduleCode]="moduleCode"
  [functionCode]="functionCode"
  [hideAuditTrail]="true"
  [hideAttachments]="true"
  [showExport]="false"
  [isViewRight]="canView"
  (onWorkflowActions)="onWorkflowAction($event)"
  [templateRefObj]="{
    general: generalTab,
    specifications: specificationsTab,
    yard_selection: yardSelectionTab,
    project_monitoring: projectMonitoringTab,
    technical_specification: technical_specification,
    attachmentss: attachmentss,
    rfq: rfq,
    gantt_chart: gantt_chart,
    statement_of_facts: statement_of_facts,
    cost_updates: cost_updates,
    reporting: reportingTab
  }"
  [sectionHeaderTemplateRef]="{ technical_specification: specificationsButtonsTmpl }"
  [slideMenus]="menu"
>
  <ng-template
    #generalTab
    let-section
  >
    <ng-container [ngSwitch]="section.SectionCode">
      <div *ngSwitchCase="'tasks'">
        <!-- TODO add tasks component here -->
      </div>
    </ng-container>
  </ng-template>

  <ng-template
    #specificationsTab
    let-section
  >
    <ng-container [ngSwitch]="section.SectionCode">
      <div *ngSwitchCase="eSideMenuId.TechnicalSpecification">
        <div #technical_specification>
          <jb-specifications
            #specificationsComponent
            [projectId]="projectUid"
            [vesselUid]="vesselUid"
            [vesselType]="vesselType"
          ></jb-specifications>
        </div>
      </div>

      <div *ngSwitchCase="eSideMenuId.Attachments">
        <div #attachmentss>
          <jb-attachments
            *ngIf="attachmentConfig"
            #attachmentsComponent
            class="attachments"
            [attachConfig]="attachmentConfig"
            [onUploadBtn]="false"
            [defaultActions]="true"
          ></jb-attachments>
        </div>
      </div>
    </ng-container>
  </ng-template>

  <ng-template
    #yardSelectionTab
    let-section
  >
    <ng-container [ngSwitch]="section.SectionCode">
      <div *ngSwitchCase="eSideMenuId.RFQ">
        <div #rfq>
          <jb-drydock-rfq
            [projectId]="projectUid"
            #rfqComponent
          ></jb-drydock-rfq>
        </div>
      </div>
    </ng-container>
  </ng-template>

  <ng-template
    #projectMonitoringTab
    let-section
  >
    <ng-container [ngSwitch]="section.SectionCode">
      <div *ngSwitchCase="eSideMenuId.GanttChart">
        <div #gantt_chart>
          <jb-project-gantt-chart
            #ganttChartComponent
            [projectId]="projectUid"
          ></jb-project-gantt-chart>
        </div>
      </div>
      <div *ngSwitchCase="eSideMenuId.StatementOfFacts">
        <div #statement_of_facts>
          <jb-statement-of-facts
            #statementOfFactsComponent
            [projectId]="projectUid"
          ></jb-statement-of-facts>
        </div>
      </div>
      <div *ngSwitchCase="eSideMenuId.CostUpdates">
        <div #cost_updates>
          <jb-cost-updates
            [projectId]="projectUid"
            (updatesCostsData)="updatesCostsData($event)"
          ></jb-cost-updates>
        </div>
      </div>
    </ng-container>
  </ng-template>
</jb-task-manager-details>

<ng-template
  #reportingTab
  let-section
>
  <ng-container [ngSwitch]="section.SectionCode">
    <div *ngSwitchCase="eSideMenuId.DailyReports">
      <div #daily_reports>
        <jb-drydock-daily-reports
          #dailyReportsComponent
          [projectId]="projectUid"
        ></jb-drydock-daily-reports>
      </div>
    </div>
  </ng-container>
</ng-template>

<ng-template #specificationsButtonsTmpl>
  <!-- Return after export to PDF is done -->
  <!-- <jb-button
    type="NoButton"
    icon="icons8-anchor"
    label="Export"
  ></jb-button> -->
  <jb-split-button
    type="NoButton"
    label="Create new"
    [model]="specificationsCreateNewItems"
  ></jb-split-button>
</ng-template>

<jb-progress-spinner
  class="progress-spinner"
  *ngIf="showLoader"
  [theme]="'figma'"
></jb-progress-spinner>

<jb-dialog
  [dialogContent]="importDialogueProperties"
  [(dialogVisible)]="isImportDialogVisible"
  (closeDialog)="closeGuidanceDialog()"
>
  <ng-container jb-dialog-body>
    <div>
      <jb-uploads
        class="jms-upload-ui"
        #uploadRef
        [uploads]="uploadConfig"
        [syncTo]="syncTo"
        [parentControl]="true"
        (parentDispatch)="onSelectNewFile($event)"
        (onSelect)="onSelectNewFile($event)"
      ></jb-uploads>
    </div>
  </ng-container>

  <ng-container jb-dialog-footer>
    <jb-dialog-footer
      [okBtnLabel]="okBtnLabel"
      (ok)="uploadInvoice()"
      (cancel)="closeGuidanceDialog()"
    ></jb-dialog-footer>
  </ng-container>
</jb-dialog>
